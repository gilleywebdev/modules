var $spreadsheet=$(".spreadsheet"),$google=$(".google");$spreadsheet.handsontable({rows:1,cols:3,legend:[{match:function(e,t,n){return t===0},readOnly:!0}],rowHeaders:!1,colHeaders:["Page","Title","Description"],onChange:function(e){var t=$(".spreadsheet table").width(),n=t+15;$google.css("left",n)},minSpareRows:1});var handsontable=$spreadsheet.data("handsontable");$.ajax({url:"/admin/seo/load",dataType:"json",type:"GET",success:function(e){handsontable.loadData(e.data)}});$(".submit").click(function(){$.ajax({url:"/admin/seo/save",data:{data:handsontable.getData()},dataType:"json",type:"POST",success:function(){window.location.href="/admin/seo/index/success/seo_updated"}})});$spreadsheet.mousedown(function(){var e=$(".current").position();$google.css("top",e.top-15);$google.hide()});$spreadsheet.mouseup(function(){selected=handsontable.getSelected();if(selected[0]===selected[2]){$google.show();x=selected[0];y=selected[1];var e=handsontable.getDataAtCell(x,0),t=handsontable.getDataAtCell(x,1),n=handsontable.getDataAtCell(x,2);t.length>69&&(t=jQuery.trim(t).substring(0,69).split(" ").slice(0,-1).join(" ")+"...");n.length>156&&(n=jQuery.trim(n).substring(0,156).split(" ").slice(0,-1).join(" ")+"...");var r='<p class="google_title">'+t+"</p>";r=r+'<p class="google_link">http://www.gilleywebdev.com/'+e+"</p>";r=r+'<p class="google_description">'+n+"</p>";$google.html(r);$(this).data("y",y)}});$(".handsontableInput").keyup(function(){$spreadsheet.data("y")===1&&$(".google_title").text($(this).val());$spreadsheet.data("y")===2&&$(".google_description").text($(this).val())});
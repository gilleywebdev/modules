/*!
 * jScrollPane - v2.0.0beta12 - 2012-06-21
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */// Script: jScrollPane - cross browser customisable scrollbars
//
// *Version: 2.0.0beta12, Last updated: 2012-06-21*
//
// Project Home - http://jscrollpane.kelvinluck.com/
// GitHub       - http://github.com/vitch/jScrollPane
// Source       - http://github.com/vitch/jScrollPane/raw/master/script/jquery.jscrollpane.js
// (Minified)   - http://github.com/vitch/jScrollPane/raw/master/script/jquery.jscrollpane.min.js
//
// About: License
//
// Copyright (c) 2012 Kelvin Luck
// Dual licensed under the MIT or GPL Version 2 licenses.
// http://jscrollpane.kelvinluck.com/MIT-LICENSE.txt
// http://jscrollpane.kelvinluck.com/GPL-LICENSE.txt
//
// About: Examples
//
// All examples and demos are available through the jScrollPane example site at:
// http://jscrollpane.kelvinluck.com/
//
// About: Support and Testing
//
// This plugin is tested on the browsers below and has been found to work reliably on them. If you run
// into a problem on one of the supported browsers then please visit the support section on the jScrollPane
// website (http://jscrollpane.kelvinluck.com/) for more information on getting support. You are also
// welcome to fork the project on GitHub if you can contribute a fix for a given issue. 
//
// jQuery Versions - tested in 1.4.2+ - reported to work in 1.3.x
// Browsers Tested - Firefox 3.6.8, Safari 5, Opera 10.6, Chrome 5.0, IE 6, 7, 8
//
// About: Release History
//
// 2.0.0beta12 - (In progress)
// 2.0.0beta11 - (2012-05-14)
// 2.0.0beta10 - (2011-04-17) cleaner required size calculation, improved keyboard support, stickToBottom/Left, other small fixes
// 2.0.0beta9 - (2011-01-31) new API methods, bug fixes and correct keyboard support for FF/OSX
// 2.0.0beta8 - (2011-01-29) touchscreen support, improved keyboard support
// 2.0.0beta7 - (2011-01-23) scroll speed consistent (thanks Aivo Paas)
// 2.0.0beta6 - (2010-12-07) scrollToElement horizontal support
// 2.0.0beta5 - (2010-10-18) jQuery 1.4.3 support, various bug fixes
// 2.0.0beta4 - (2010-09-17) clickOnTrack support, bug fixes
// 2.0.0beta3 - (2010-08-27) Horizontal mousewheel, mwheelIntent, keyboard support, bug fixes
// 2.0.0beta2 - (2010-08-21) Bug fixes
// 2.0.0beta1 - (2010-08-17) Rewrite to follow modern best practices and enable horizontal scrolling, initially hidden
//							 elements and dynamically sized elements.
// 1.x - (2006-12-31 - 2010-07-31) Initial version, hosted at googlecode, deprecated
(function(e,t,n){e.fn.jScrollPane=function(r){function i(r,i){function V(t){var i,o,g,y,w,E,x=!1,T=!1;s=t;if(u===n){w=r.scrollTop();E=r.scrollLeft();r.css({overflow:"hidden",padding:0});a=r.innerWidth()+F;f=r.innerHeight();r.width(a);u=e('<div class="jspPane" />').css("padding",j).append(r.children());l=e('<div class="jspContainer" />').css({width:a+"px",height:f+"px"}).append(u).appendTo(r)}else{r.css("width","");x=s.stickToBottom&&mt();T=s.stickToRight&&gt();y=r.innerWidth()+F!=a||r.outerHeight()!=f;if(y){a=r.innerWidth()+F;f=r.innerHeight();l.css({width:a+"px",height:f+"px"})}if(!y&&I==c&&u.outerHeight()==h){r.width(a);return}I=c;u.css("width","");r.width(a);l.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}u.css("overflow","auto");t.contentWidth?c=t.contentWidth:c=u[0].scrollWidth;h=u[0].scrollHeight;u.css("overflow","");p=c/a;d=h/f;v=d>1;m=p>1;if(!m&&!v){r.removeClass("jspScrollable");u.css({top:0,width:l.width()-F});bt();St();Tt();rt()}else{r.addClass("jspScrollable");i=s.maintainPosition&&(b||S);if(i){o=dt();g=vt()}J();Q();Y();if(i){ht(T?c-a:o,!1);ct(x?h-f:g,!1)}Et();yt();kt();s.enableKeyboardNavigation&&xt();s.clickOnTrack&&nt();Nt();s.hijackInternalLinks&&Ct()}s.autoReinitialise&&!B?B=setInterval(function(){V(s)},s.autoReinitialiseDelay):!s.autoReinitialise&&B&&clearInterval(B);w&&r.scrollTop(0)&&ct(w,!1);E&&r.scrollLeft(0)&&ht(E,!1);r.trigger("jsp-initialised",[m||v])}function J(){if(v){l.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />')));x=l.find(">.jspVerticalBar");T=x.find(">.jspTrack");g=T.find(">.jspDrag");if(s.showArrows){L=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",et(0,-1)).bind("click.jsp",wt);A=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",et(0,1)).bind("click.jsp",wt);if(s.arrowScrollOnHover){L.bind("mouseover.jsp",et(0,-1,L));A.bind("mouseover.jsp",et(0,1,A))}Z(T,s.verticalArrowPositions,L,A)}C=f;l.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){C-=e(this).outerHeight()});g.hover(function(){g.addClass("jspHover")},function(){g.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt);g.addClass("jspActive");var n=t.pageY-g.position().top;e("html").bind("mousemove.jsp",function(e){st(e.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",it);return!1});K()}}function K(){T.height(C+"px");b=0;N=s.verticalGutter+T.outerWidth();u.width(a-N-F);try{x.position().left===0&&u.css("margin-left",N+"px")}catch(e){}}function Q(){if(m){l.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />')));O=l.find(">.jspHorizontalBar");M=O.find(">.jspTrack");w=M.find(">.jspDrag");if(s.showArrows){P=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",et(-1,0)).bind("click.jsp",wt);H=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",et(1,0)).bind("click.jsp",wt);if(s.arrowScrollOnHover){P.bind("mouseover.jsp",et(-1,0,P));H.bind("mouseover.jsp",et(1,0,H))}Z(M,s.horizontalArrowPositions,P,H)}w.hover(function(){w.addClass("jspHover")},function(){w.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt);w.addClass("jspActive");var n=t.pageX-w.position().left;e("html").bind("mousemove.jsp",function(e){ut(e.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",it);return!1});_=l.innerWidth();G()}}function G(){l.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){_-=e(this).outerWidth()});M.width(_+"px");S=0}function Y(){if(m&&v){var t=M.outerHeight(),n=T.outerWidth();C-=t;e(O).find(">.jspCap:visible,>.jspArrow").each(function(){_+=e(this).outerWidth()});_-=n;f-=n;a-=t;M.parent().append(e('<div class="jspCorner" />').css("width",t+"px"));K();G()}m&&u.width(l.outerWidth()-F+"px");h=u.outerHeight();d=h/f;if(m){D=Math.ceil(1/p*_);D>s.horizontalDragMaxWidth?D=s.horizontalDragMaxWidth:D<s.horizontalDragMinWidth&&(D=s.horizontalDragMinWidth);w.width(D+"px");E=_-D;at(S)}if(v){k=Math.ceil(1/d*C);k>s.verticalDragMaxHeight?k=s.verticalDragMaxHeight:k<s.verticalDragMinHeight&&(k=s.verticalDragMinHeight);g.height(k+"px");y=C-k;ot(b)}}function Z(e,t,n,r){var i="before",s="after",o;t=="os"&&(t=/Mac/.test(navigator.platform)?"after":"split");if(t==i)s=t;else if(t==s){i=t;o=n;n=r;r=o}e[i](n)[s](r)}function et(e,t,n){return function(){tt(e,t,this,n);this.blur();return!1}}function tt(t,n,r,i){r=e(r).addClass("jspActive");var u,a,f=!0,l=function(){t!==0&&o.scrollByX(t*s.arrowButtonSpeed);n!==0&&o.scrollByY(n*s.arrowButtonSpeed);a=setTimeout(l,f?s.initialDelay:s.arrowRepeatFreq);f=!1};l();u=i?"mouseout.jsp":"mouseup.jsp";i=i||e("html");i.bind(u,function(){r.removeClass("jspActive");a&&clearTimeout(a);a=null;i.unbind(u)})}function nt(){rt();v&&T.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),u=t.pageY-i.top-b,a,l=!0,c=function(){var e=r.offset(),n=t.pageY-e.top-k/2,i=f*s.scrollPagePercent,d=y*i/(h-f);if(u<0)b-d>n?o.scrollByY(-i):st(n);else{if(!(u>0)){p();return}b+d<n?o.scrollByY(i):st(n)}a=setTimeout(c,l?s.initialDelay:s.trackClickRepeatFreq);l=!1},p=function(){a&&clearTimeout(a);a=null;e(document).unbind("mouseup.jsp",p)};c();e(document).bind("mouseup.jsp",p);return!1}});m&&M.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),u=t.pageX-i.left-S,f,l=!0,h=function(){var e=r.offset(),n=t.pageX-e.left-D/2,i=a*s.scrollPagePercent,d=E*i/(c-a);if(u<0)S-d>n?o.scrollByX(-i):ut(n);else{if(!(u>0)){p();return}S+d<n?o.scrollByX(i):ut(n)}f=setTimeout(h,l?s.initialDelay:s.trackClickRepeatFreq);l=!1},p=function(){f&&clearTimeout(f);f=null;e(document).unbind("mouseup.jsp",p)};h();e(document).bind("mouseup.jsp",p);return!1}})}function rt(){M&&M.unbind("mousedown.jsp");T&&T.unbind("mousedown.jsp")}function it(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");g&&g.removeClass("jspActive");w&&w.removeClass("jspActive")}function st(e,t){if(!v)return;e<0?e=0:e>y&&(e=y);t===n&&(t=s.animateScroll);if(t)o.animate(g,"top",e,ot);else{g.css("top",e);ot(e)}}function ot(e){e===n&&(e=g.position().top);l.scrollTop(0);b=e;var t=b===0,i=b==y,s=e/y,o=-s*(h-f);if(q!=t||U!=i){q=t;U=i;r.trigger("jsp-arrow-change",[q,U,R,z])}ft(t,i);u.css("top",o);r.trigger("jsp-scroll-y",[-o,t,i]).trigger("scroll")}function ut(e,t){if(!m)return;e<0?e=0:e>E&&(e=E);t===n&&(t=s.animateScroll);if(t)o.animate(w,"left",e,at);else{w.css("left",e);at(e)}}function at(e){e===n&&(e=w.position().left);l.scrollTop(0);S=e;var t=S===0,i=S==E,s=e/E,o=-s*(c-a);if(R!=t||z!=i){R=t;z=i;r.trigger("jsp-arrow-change",[q,U,R,z])}lt(t,i);u.css("left",o);r.trigger("jsp-scroll-x",[-o,t,i]).trigger("scroll")}function ft(e,t){if(s.showArrows){L[e?"addClass":"removeClass"]("jspDisabled");A[t?"addClass":"removeClass"]("jspDisabled")}}function lt(e,t){if(s.showArrows){P[e?"addClass":"removeClass"]("jspDisabled");H[t?"addClass":"removeClass"]("jspDisabled")}}function ct(e,t){var n=e/(h-f);st(n*y,t)}function ht(e,t){var n=e/(c-a);ut(n*E,t)}function pt(t,n,r){var i,o,u,c=0,h=0,p,d,v,m,g,y;try{i=e(t)}catch(b){return}o=i.outerHeight();u=i.outerWidth();l.scrollTop(0);l.scrollLeft(0);while(!i.is(".jspPane")){c+=i.position().top;h+=i.position().left;i=i.offsetParent();if(/^body|html$/i.test(i[0].nodeName))return}p=vt();v=p+f;c<p||n?g=c-s.verticalGutter:c+o>v&&(g=c-f+o+s.verticalGutter);g&&ct(g,r);d=dt();m=d+a;h<d||n?y=h-s.horizontalGutter:h+u>m&&(y=h-a+u+s.horizontalGutter);y&&ht(y,r)}function dt(){return-u.position().left}function vt(){return-u.position().top}function mt(){var e=h-f;return e>20&&e-vt()<10}function gt(){var e=c-a;return e>20&&e-dt()<10}function yt(){l.unbind(X).bind(X,function(e,t,n,r){var i=S,u=b;o.scrollBy(n*s.mouseWheelSpeed,-r*s.mouseWheelSpeed,!1);return i==S&&u==b})}function bt(){l.unbind(X)}function wt(){return!1}function Et(){u.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){pt(e.target,!1)})}function St(){u.find(":input,a").unbind("focus.jsp")}function xt(){function a(){var e=S,r=b;switch(t){case 40:o.scrollByY(s.keyboardSpeed,!1);break;case 38:o.scrollByY(-s.keyboardSpeed,!1);break;case 34:case 32:o.scrollByY(f*s.scrollPagePercent,!1);break;case 33:o.scrollByY(-f*s.scrollPagePercent,!1);break;case 39:o.scrollByX(s.keyboardSpeed,!1);break;case 37:o.scrollByX(-s.keyboardSpeed,!1)}n=e!=S||r!=b;return n}var t,n,i=[];m&&i.push(O[0]);v&&i.push(x[0]);u.focus(function(){r.focus()});r.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(r){if(r.target!==this&&(!i.length||!e(r.target).closest(i).length))return;var s=S,o=b;switch(r.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:t=r.keyCode;a();break;case 35:ct(h-f);t=null;break;case 36:ct(0);t=null}n=r.keyCode==t&&s!=S||o!=b;return!n}).bind("keypress.jsp",function(e){e.keyCode==t&&a();return!n});if(s.hideFocus){r.css("outline","none");"hideFocus"in l[0]&&r.attr("hideFocus",!0)}else{r.css("outline","");"hideFocus"in l[0]&&r.attr("hideFocus",!1)}}function Tt(){r.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Nt(){if(location.hash&&location.hash.length>1){var t,n,r=escape(location.hash.substr(1));try{t=e("#"+r+', a[name="'+r+'"]')}catch(i){return}if(t.length&&u.find(r))if(l.scrollTop()===0)n=setInterval(function(){if(l.scrollTop()>0){pt(t,!0);e(document).scrollTop(l.position().top);clearInterval(n)}},50);else{pt(t,!0);e(document).scrollTop(l.position().top)}}}function Ct(){if(e(document.body).data("jspHijack"))return;e(document.body).data("jspHijack",!0);e(document.body).delegate("a[href*=#]","click",function(n){var r=this.href.substr(0,this.href.indexOf("#")),i=location.href,s,o,u,a,f,l;location.href.indexOf("#")!==-1&&(i=location.href.substr(0,location.href.indexOf("#")));if(r!==i)return;s=escape(this.href.substr(this.href.indexOf("#")+1));o;try{o=e("#"+s+', a[name="'+s+'"]')}catch(c){return}if(!o.length)return;u=o.closest(".jspScrollable");a=u.data("jsp");a.scrollToElement(o,!0);if(u[0].scrollIntoView){f=e(t).scrollTop();l=o.offset().top;(l<f||l>f+e(t).height())&&u[0].scrollIntoView()}n.preventDefault()})}function kt(){var e,t,n,r,i,s=!1;l.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(o){var u=o.originalEvent.touches[0];e=dt();t=vt();n=u.pageX;r=u.pageY;i=!1;s=!0}).bind("touchmove.jsp",function(u){if(!s)return;var a=u.originalEvent.touches[0],f=S,l=b;o.scrollTo(e+n-a.pageX,t+r-a.pageY);i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5;return f==S&&l==b}).bind("touchend.jsp",function(e){s=!1}).bind("click.jsp-touchclick",function(e){if(i){i=!1;return!1}})}function Lt(){var e=vt(),t=dt();r.removeClass("jspScrollable").unbind(".jsp");r.replaceWith(W.append(u.children()));W.scrollTop(e);W.scrollLeft(t);B&&clearInterval(B)}var s,o=this,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=!0,R=!0,U=!1,z=!1,W=r.clone(!1,!1).empty(),X=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";j=r.css("paddingTop")+" "+r.css("paddingRight")+" "+r.css("paddingBottom")+" "+r.css("paddingLeft");F=(parseInt(r.css("paddingLeft"),10)||0)+(parseInt(r.css("paddingRight"),10)||0);e.extend(o,{reinitialise:function(t){t=e.extend({},s,t);V(t)},scrollToElement:function(e,t,n){pt(e,t,n)},scrollTo:function(e,t,n){ht(e,n);ct(t,n)},scrollToX:function(e,t){ht(e,t)},scrollToY:function(e,t){ct(e,t)},scrollToPercentX:function(e,t){ht(e*(c-a),t)},scrollToPercentY:function(e,t){ct(e*(h-f),t)},scrollBy:function(e,t,n){o.scrollByX(e,n);o.scrollByY(t,n)},scrollByX:function(e,t){var n=dt()+Math[e<0?"floor":"ceil"](e),r=n/(c-a);ut(r*E,t)},scrollByY:function(e,t){var n=vt()+Math[e<0?"floor":"ceil"](e),r=n/(h-f);st(r*y,t)},positionDragX:function(e,t){ut(e,t)},positionDragY:function(e,t){st(e,t)},animate:function(e,t,n,r){var i={};i[t]=n;e.animate(i,{duration:s.animateDuration,easing:s.animateEase,queue:!1,step:r})},getContentPositionX:function(){return dt()},getContentPositionY:function(){return vt()},getContentWidth:function(){return c},getContentHeight:function(){return h},getPercentScrolledX:function(){return dt()/(c-a)},getPercentScrolledY:function(){return vt()/(h-f)},getIsScrollableH:function(){return m},getIsScrollableV:function(){return v},getContentPane:function(){return u},scrollToBottom:function(e){st(y,e)},hijackInternalLinks:e.noop,destroy:function(){Lt()}});V(i)}r=e.extend({},e.fn.jScrollPane.defaults,r);e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){r[this]=r[this]||r.speed});return this.each(function(){var t=e(this),n=t.data("jsp");if(n)n.reinitialise(r);else{e("script",t).filter("[type=text/javascript],not([type])").remove();n=new i(t,r);t.data("jsp",n)}})};e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}})(jQuery,this);
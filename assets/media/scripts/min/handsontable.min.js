/**
 * Handsontable 0.5.0
 * Handsontable is a simple jQuery plugin for editable tables with basic copy-paste compatibility with Excel and Google Docs
 *
 * Copyright 2012, Marcin Warpechowski
 * Licensed under the MIT license.
 * http://warpech.github.com/jquery-handsontable/
 *//*jslint white: true, browser: true, plusplus: true, indent: 4, maxerr: 50 */var Handsontable={extension:{},helper:{}};(function(e,t,n){"use strict";n.Core=function(r,i){function v(){var e=s.editProxy.data("typeahead");return e&&e.$menu.is(":visible")?e:!1}function m(){var t=e('<div style="width:150px;height:150px;overflow:hidden;position:absolute;top:200px;left:200px"><div style="width:100%;height:100%;position:absolute">x</div>');e("body").append(t);var n=e(t[0].firstChild),r=n.innerWidth(),i=n.innerHeight();t[0].style.overflow="scroll";r-=n.innerWidth();i-=n.innerHeight();t.remove();return{width:r,height:i}}function g(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})}function x(e){var t;if(e.indexOf('"')===-1){var n,r;t=e.split("\n");t.length>1&&t[t.length-1]===""&&t.pop();for(n=0,r=t.length;n<r;n++)t[n]=t[n].split("	")}else{t=[[]];var i,s;while(i=E.exec(e)){var o=i[1];o.length&&o!=w&&t.push([]);i[2]?s=i[2].replace(S,'"'):s=i[3];t[t.length-1].push(s)}}return t}function N(t,n){this.$container=t;var r=this.$container[0];if(n.bg){this.bg=document.createElement("div");this.bg.className="htBorderBg "+n.className;r.insertBefore(this.bg,r.firstChild)}this.main=document.createElement("div");this.main.style.position="absolute";this.main.style.top=0;this.main.style.left=0;this.main.innerHTML=(new Array(5)).join('<div class="htBorder '+n.className+'"></div>');this.disappear();r.appendChild(this.main);var i=this.main.childNodes;this.top=i[0];this.left=i[1];this.bottom=i[2];this.right=i[3];this.borderWidth=e(this.left).width()}function C(t){this.$container=t;var n=this.$container[0];this.handle=document.createElement("div");this.handle.className="htFillHandle";this.disappear();n.appendChild(this.handle);var r=this;e(this.handle).mousedown(function(){r.isDragged=1})}this.container=r;var s,o,u,a,f,l,c,h,p=this;s={settings:{},isMouseOverTable:!1,isMouseDown:!1,isCellEdited:!1,selStart:null,selEnd:null,editProxy:!1,isPopulated:null,scrollable:null,hasLegend:null,lastAutoComplete:null,undoRedo:null,extensions:{},legendDirty:null};var d="",y=e.browser.msie&&parseInt(e.browser.version,10)<=7;this.minWidthFix=function(e){y&&(e.className?e.innerHTML='<div class="minWidthFix '+e.className+'">'+e.innerHTML+"</div>":e.innerHTML='<div class="minWidthFix">'+e.innerHTML+"</div>")};var b=e.browser.msie&&parseInt(e.browser.version,10)<=7;this.positionFix=function(e){if(b){e.top<0&&(e.top=0);e.left<0&&(e.left=0)}};var w="	",E=new RegExp("(\\"+w+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+w+"\\r\\n]*))","gi"),S=/""/g;o={data:[],createRow:function(e){var t=[];for(var n=0;n<p.colCount;n++)t.push("");!e||e.row>=p.rowCount?o.data.push(t):o.data.splice(e.row,0,t)},createCol:function(e){var t=0;if(!e||e.col>=p.colCount)for(;t<p.rowCount;t++)o.data[t].push("");else for(;t<p.rowCount;t++)o.data[t].splice(e.col,0,"")},removeRow:function(e,t){!e||e.row===p.rowCount-1?o.data.pop():o.data.splice(e.row,t.row-e.row+1)},removeCol:function(e,t){var n=0;if(!e||e.col===p.colCount-1)for(;n<p.rowCount;n++)o.data[n].pop();else{var r=t.col-e.col+1;for(;n<p.rowCount;n++)o.data[n].splice(e.col,r)}},get:function(e,t){return o.data[e]?o.data[e][t]:null},set:function(e,t,n){o.data[e][t]=n},clear:function(){for(var e=0;e<p.rowCount;e++)for(var t=0;t<p.colCount;t++)o.data[e][t]=""},getAll:function(){return o.data},getRange:function(e,t){var n,r,i,s,u=[],a;r=Math.max(e.row,t.row);s=Math.max(e.col,t.col);for(n=Math.min(e.row,t.row);n<=r;n++){a=[];for(i=Math.min(e.col,t.col);i<=s;i++)a.push(o.data[n][i]);u.push(a)}return u},getText:function(e,t){var n=o.getRange(e,t),r="",i,s,u,a,f=/<(?:.|\n)*?>/gm;for(i=0,s=n.length;i<s;i++){for(u=0,a=n[i].length;u<a;u++){u>0&&(r+="	");n[i][u].indexOf("\n")>-1?r+='"'+n[i][u].replace(f,"").replace(/"/g,'""')+'"':r+=n[i][u].replace(f,"")}i!==s-1&&(r+="\n")}r=r.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");return r}};u={alter:function(t,n,r){var i,f,l,c,h,d,v,m;i=e.extend(!0,[],o.getAll());switch(t){case"insert_row":o.createRow(n);u.createRow(n);p.blockedCols.refresh();if(s.selStart&&s.selStart.row>=n.row){s.selStart.row=s.selStart.row+1;a.transformEnd(1,0)}else a.transformEnd(0,0);break;case"insert_col":o.createCol(n);u.createCol(n);p.blockedRows.refresh();if(s.selStart&&s.selStart.col>=n.col){s.selStart.col=s.selStart.col+1;a.transformEnd(0,1)}else a.transformEnd(0,0);break;case"remove_row":o.removeRow(n,r);u.removeRow(n,r);m=u.keepEmptyRows();m||p.blockedCols.refresh();a.transformEnd(0,0);break;case"remove_col":o.removeCol(n,r);u.removeCol(n,r);m=u.keepEmptyRows();m||p.blockedRows.refresh();a.transformEnd(0,0)}l=[];f=o.getAll();for(c=0,h=f.length;c<h;c++)for(d=0,v=f[c].length;d<v;d++)l.push([c,d,i[c]?i[c][d]:null,f[c][d]]);p.container.triggerHandler("datachange.handsontable",[l,"alter"])},createRow:function(e){var t,n,r,i;t=document.createElement("tr");p.blockedCols.createRow(t);for(n=0;n<p.colCount;n++){t.appendChild(i=document.createElement("td"));p.minWidthFix(i)}if(!e||e.row>=p.rowCount){s.tableBody.appendChild(t);r=p.rowCount}else{var o=u.getCellAtCoords(e).parentNode;s.tableBody.insertBefore(t,o);r=e.row}p.rowCount++;for(n=0;n<p.colCount;n++)u.updateLegend({row:r,col:n})},createCol:function(e){var t=s.tableBody.childNodes,n,r,i;p.blockedRows.createCol();if(!e||e.col>=p.colCount){for(n=0;n<p.rowCount;n++){t[n].appendChild(i=document.createElement("td"));p.minWidthFix(i)}r=p.colCount}else{for(n=0;n<p.rowCount;n++){t[n].insertBefore(i=document.createElement("td"),u.getCellAtCoords({row:n,col:e.col}));p.minWidthFix(i)}r=e.col}p.colCount++;for(n=0;n<p.rowCount;n++)u.updateLegend({row:n,col:r})},removeRow:function(t,n){if(!t||t.row===p.rowCount-1){e(s.tableBody.childNodes[p.rowCount-1]).remove();p.rowCount--}else for(var r=n.row;r>=t.row;r--){e(s.tableBody.childNodes[r]).remove();p.rowCount--}},removeCol:function(t,n){var r=s.tableBody.childNodes,i,o;p.blockedRows&&(i=p.table.find("thead th"));var u=0;if(!t||t.col===p.colCount-1){for(;u<p.rowCount;u++){e(r[u].childNodes[p.colCount+p.blockedCols.count()-1]).remove();i&&i.eq(p.colCount+p.blockedCols.count()-1).remove()}p.colCount--}else{for(;u<p.rowCount;u++)for(o=n.col;o>=t.col;o--)e(r[u].childNodes[o+p.blockedCols.count()]).remove();if(i)for(o=n.col;o>=t.col;o--)i.eq(o+p.blockedCols.count()).remove();p.colCount-=n.col-t.col+1}},keepEmptyRows:function(){var t,n,r,i,f=0,l=0,c,h=!1,d=!1,v=e(s.tableBody);t=o.getAll();c=t.length;e:for(n=c-1;n>=0;n--){for(r=0,i=t[n].length;r<i;r++)if(t[n][r]!=="")break e;f++}if(p.rowCount<s.settings.rows||f<s.settings.minSpareRows)for(;p.rowCount<s.settings.rows||f<s.settings.minSpareRows;f++){o.createRow();u.createRow();h=!0}if(s.settings.minHeight&&v.height()>0&&v.height()<=s.settings.minHeight)while(v.height()<=s.settings.minHeight){o.createRow();u.createRow();h=!0}t=o.getAll();c=t.length;if(c>0){i=t[0].length;t:for(r=i-1;r>=0;r--){for(n=0;n<c;n++)if(t[n][r]!=="")break t;l++}}if(p.colCount<s.settings.cols||l<s.settings.minSpareCols)for(;p.colCount<s.settings.cols||l<s.settings.minSpareCols;l++){o.createCol();u.createCol();d=!0}if(s.settings.minWidth&&v.width()>0&&v.width()<=s.settings.minWidth)while(v.width()<=s.settings.minWidth){o.createCol();u.createCol();d=!0}if(!h&&s.settings.enterBeginsEditing)for(;s.settings.rows&&p.rowCount>s.settings.rows&&s.settings.minSpareRows&&f>s.settings.minSpareRows&&(!s.settings.minHeight||v.height()-v.find("tr:last").height()-4>s.settings.minHeight);f--){u.removeRow();o.removeRow();h=!0}if(h&&s.selStart)if(s.selStart.row>p.rowCount-1){s.selStart.row=p.rowCount-1;s.selEnd.row>s.selStart.row&&(s.selEnd.row=s.selStart.row)}else if(s.selEnd.row>p.rowCount-1){s.selEnd.row=p.rowCount-1;s.selStart.row>s.selEnd.row&&(s.selStart.row=s.selEnd.row)}if(!d&&s.settings.enterBeginsEditing)for(;s.settings.cols&&p.colCount>s.settings.cols&&s.settings.minSpareCols&&l>s.settings.minSpareCols&&(!s.settings.minWidth||v.width()-v.find("tr:last").find("td:last").width()-4>s.settings.minWidth);l--){o.removeCol();u.removeCol();d=!0}if(d&&s.selStart)if(s.selStart.col>p.colCount-1){s.selStart.col=p.colCount-1;s.selEnd.col>s.selStart.col&&(s.selEnd.col=s.selStart.col)}else if(s.selEnd.col>p.colCount-1){s.selEnd.col=p.colCount-1;s.selStart.col>s.selEnd.col&&(s.selStart.col=s.selEnd.col)}if(h||d){a.refreshBorders();p.blockedCols.refresh();p.blockedRows.refresh()}return h||d},updateLegend:function(t){if(s.settings.legend||s.hasLegend){var n=e(u.getCellAtCoords(t));n.removeAttr("style").removeAttr("title").removeData("readOnly");n[0].className="";n.find("img").remove()}if(s.settings.legend)for(var r=0,i=s.settings.legend.length;r<i;r++){var a=s.settings.legend[r],f;if(a.match(t.row,t.col,o.getAll)){s.hasLegend=!0;typeof a.style!="undefined"&&n.css(a.style);typeof a.readOnly!="undefined"&&n.data("readOnly",a.readOnly);typeof a.title!="undefined"&&n.attr("title",a.title);typeof a.className!="undefined"&&n.addClass(a.className);if(typeof a.icon!="undefined"&&typeof a.icon.src!="undefined"&&typeof a.icon.click!="undefined"){f=e("<img />").attr("src",a.icon.src).addClass("icon");f.on("click",function(e){return function(t){var n=e.icon.click;n.call(p,s.selStart.row,s.selStart.col,o.getAll,t.target)}}(a));n.append(f)}}}},isCellWritable:function(e){return s.isPopulated&&e.data("readOnly")?!1:!0},populateFromArray:function(t,n,r,i,o){var a,f,l,c,h,d,v=[],m={};f=n.length;if(f===0)return!1;m.row=t.row;m.col=t.col;for(a=0;a<f;a++){if(r&&m.row>r.row||!s.settings.minSpareRows&&m.row>p.rowCount-1)break;m.col=t.col;c=n[a]?n[a].length:0;for(l=0;l<c;l++){if(r&&m.col>r.col||!s.settings.minSpareCols&&m.col>p.colCount-1)break;h=u.getCellAtCoords(m);u.isCellWritable(e(h))&&v.push([m.row,m.col,n[a][l],i]);m.col++;r&&l===c-1&&(l=-1)}m.row++;r&&a===f-1&&(a=-1)}d=p.setDataAtCell(v,null,null,null,o||"populateFromArray");return d},clear:function(){var t=u.getAllCells();for(var n=0,r=t.length;n<r;n++){e(t[n]).empty();p.minWidthFix(t[n]);u.updateLegend(u.getCellCoords(t[n]))}},getCellCoords:function(e){return{row:e.parentNode.rowIndex-p.blockedRows.count(),col:e.cellIndex-p.blockedCols.count()}},getCellAtCoords:function(e){if(e.row<0||e.col<0)return null;var t=s.tableBody.childNodes[e.row];return t?t.childNodes[e.col+p.blockedCols.count()]:null},getCornerCoords:function(t){function n(t,n,r){function i(e){return e[r]}return Array.prototype.map?t.apply(Math,n.map(i)):t.apply(Math,e.map(n,i))}return{TL:{row:n(Math.min,t,"row"),col:n(Math.min,t,"col")},BR:{row:n(Math.max,t,"row"),col:n(Math.max,t,"col")}}},getCellsAtCoords:function(e,t){var n=u.getCornerCoords([e,t]),r,i,s=[];for(r=n.TL.row;r<=n.BR.row;r++)for(i=n.TL.col;i<=n.BR.col;i++)s.push(u.getCellAtCoords({row:r,col:i}));return s},getAllCells:function(){var e=[],t,n,r,i,o;t=s.tableBody.childNodes;r=p.rowCount;if(r>0){o=p.colCount;for(n=0;n<r;n++)for(i=0;i<o;i++)e.push(t[n].childNodes[i+p.blockedCols.count()])}return e}};a={setRangeStart:function(e){a.deselect();s.selStart=u.getCellCoords(e);a.setRangeEnd(e)},setRangeEnd:function(e,t){var n=u.getCellCoords(e);a.end(n);s.settings.multiSelect||(s.selStart=n);s.settings.onSelection&&s.settings.onSelection(s.selStart.row,s.selStart.col,s.selEnd.row,s.selEnd.col);a.refreshBorders();t!==!1&&l.scrollViewport(e)},refreshBorders:function(){if(!a.isSelected())return;s.fillHandle&&c.showHandle();s.currentBorder.appear([s.selStart]);l.on();f.prepare()},start:function(e){e&&(s.selStart=e);return s.selStart},end:function(e){e&&(s.selEnd=e);return s.selEnd},isMultiple:function(){return s.selEnd.col!==s.selStart.col||s.selEnd.row!==s.selStart.row},transformStart:function(e,t,n){if(s.selStart.row+e>p.rowCount-1){if(n&&s.settings.minSpareRows>0)p.alter("insert_row",p.rowCount);else if(s.settings.autoWrapCol&&s.selStart.col+t<p.colCount-1){e=1-p.rowCount;t=1}}else if(s.settings.autoWrapCol&&s.selStart.row+e<0&&s.selStart.col+t>=0){e=p.rowCount-1;t=-1}if(s.selStart.col+t>p.colCount-1){if(n&&s.settings.minSpareCols>0)p.alter("insert_col",p.colCount);else if(s.settings.autoWrapRow&&s.selStart.row+e<p.rowCount-1){e=1;t=1-p.colCount}}else if(s.settings.autoWrapRow&&s.selStart.col+t<0&&s.selStart.row+e>=0){e=-1;t=p.colCount-1}var r=u.getCellAtCoords({row:s.selStart.row+e,col:s.selStart.col+t});r?a.setRangeStart(r):a.setRangeStart(u.getCellAtCoords(s.selStart))},transformEnd:function(e,t){if(s.selEnd){var n=u.getCellAtCoords({row:s.selEnd.row+e,col:s.selEnd.col+t});n&&a.setRangeEnd(n)}},isSelected:function(){var e=a.end();return!e||typeof e.row=="undefined"?!1:!0},inInSelection:function(e){if(!a.isSelected())return!1;var t=u.getCornerCoords([s.selStart,s.selEnd]);return t.TL.row<=e.row&&t.BR.row>=e.row&&t.TL.col<=e.col&&t.BR.col>=e.col},deselect:function(){if(!a.isSelected())return;s.isCellEdited&&f.finishEditing();l.off();s.currentBorder.disappear();s.fillHandle&&c.hideHandle();a.end(!1);p.container.trigger("deselect.handsontable")},selectAll:function(){if(!s.settings.multiSelect)return;var e=u.getAllCells();if(e.length){a.setRangeStart(e[0]);a.setRangeEnd(e[e.length-1],!1)}},empty:function(){if(!a.isSelected())return;var t,n,r,i=[],f,l,c;t=u.getCellsAtCoords(s.selStart,a.end());for(n=0,r=t.length;n<r;n++){f=u.getCellCoords(t[n]);l=o.get(f.row,f.col);c=e(t[n]);if(l!==""&&u.isCellWritable(c)){c.empty();p.minWidthFix(t[n]);o.set(f.row,f.col,"");i.push([f.row,f.col,l,""]);u.updateLegend(f)}}if(i.length){p.container.triggerHandler("datachange.handsontable",[i,"empty"]);setTimeout(function(){p.blockedRows.dimensions(i);p.blockedCols.dimensions(i)},10)}u.keepEmptyRows();a.refreshBorders()}};l={init:function(){s.selectionBorder=new N(r,{className:"selection",bg:!0})},on:function(){if(!a.isSelected())return!1;a.isMultiple()?s.selectionBorder.appear([s.selStart,a.end()]):s.selectionBorder.disappear()},off:function(){if(!a.isSelected())return!1;s.selectionBorder.disappear()},scrollViewport:function(t){if(!a.isSelected())return!1;var n=e(t),r=n.offset(),i=s.scrollable.scrollLeft(),o=s.scrollable.scrollTop(),u=s.scrollable.offset(),f=p.blockedCols.count()?e(p.blockedCols.main[0].firstChild).outerWidth():2,l=p.blockedRows.count()?e(p.blockedRows.main[0].firstChild).outerHeight():2,c=r.top,h=r.left,d,v;if(u){d=s.scrollable.outerWidth();v=s.scrollable.outerHeight();c+=o-u.top;h+=i-u.left}else{d=s.scrollable.width();v=s.scrollable.height()}d-=s.scrollbarSize.width;v-=s.scrollbarSize.height;var m=n.outerHeight(),g=n.outerWidth();i+d<=h+g?setTimeout(function(){s.scrollable.scrollLeft(h+g-d)},1):i>h-f&&setTimeout(function(){s.scrollable.scrollLeft(h-f)},1);o+v<=c+m?setTimeout(function(){s.scrollable.scrollTop(c+m-v)},1):o>c-l&&setTimeout(function(){s.scrollable.scrollTop(c-l)},1)}};c={init:function(){if(!s.fillHandle){s.fillHandle=new C(r);s.fillBorder=new N(r,{className:"htFillBorder"});e(s.fillHandle.handle).on("dblclick",c.selectAdjacent)}else{s.fillHandle.disabled=!1;s.fillBorder.disabled=!1}},disable:function(){s.fillHandle.disabled=!0;s.fillBorder.disabled=!0},selectAdjacent:function(){var e,t,n,r,i;a.isMultiple()?e=s.selectionBorder.corners:e=s.currentBorder.corners;s.fillBorder.disappear();t=o.getAll();e:for(n=e.BR.row+1;n<p.rowCount;n++){for(i=e.TL.col;i<=e.BR.col;i++)if(t[n][i])break e;if(!!t[n][e.TL.col-1]||!!t[n][e.BR.col+1])r=n}if(r){c.showBorder(u.getCellAtCoords({row:r,col:e.BR.col}));c.apply()}},apply:function(){var e,t,n,r;s.fillHandle.isDragged=0;e=s.fillBorder.corners;if(!e)return;s.fillBorder.disappear();a.isMultiple()?t=s.selectionBorder.corners:t=s.currentBorder.corners;if(e.TL.row===t.TL.row&&e.TL.col<t.TL.col){n=e.TL;r={row:e.BR.row,col:t.TL.col-1}}else if(e.TL.row===t.TL.row&&e.BR.col>t.BR.col){n={row:e.TL.row,col:t.BR.col+1};r=e.BR}else if(e.TL.row<t.TL.row&&e.TL.col===t.TL.col){n=e.TL;r={row:t.TL.row-1,col:e.BR.col}}else if(e.BR.row>t.BR.row&&e.TL.col===t.TL.col){n={row:t.BR.row+1,col:e.TL.col};r=e.BR}if(n){var i=x(s.editProxy.val(),"	");u.populateFromArray(n,i,r,null,"autofill");a.setRangeStart(u.getCellAtCoords(e.TL));a.setRangeEnd(u.getCellAtCoords(e.BR))}else a.refreshBorders()},showHandle:function(){s.fillHandle.appear([s.selStart,s.selEnd])},hideHandle:function(){s.fillHandle.disappear()},showBorder:function(e){var t=u.getCellCoords(e),n=u.getCornerCoords([s.selStart,s.selEnd]);if(s.settings.fillHandle!=="horizontal"&&(n.BR.row<t.row||n.TL.row>t.row))t={row:t.row,col:n.BR.col};else{if(s.settings.fillHandle==="vertical")return;t={row:n.BR.row,col:t.col}}s.fillBorder.appear([s.selStart,s.selEnd,t])}};f={init:function(){function t(e){e.stopPropagation()}function i(){s.isCellEdited||setTimeout(function(){a.empty()},100)}function o(){s.isCellEdited||setTimeout(function(){var e=s.editProxy.val().replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),t=x(e,"	"),n=u.getCornerCoords([s.selStart,s.selEnd]),r=u.populateFromArray(n.TL,t,{row:Math.max(n.BR.row,t.length-1+n.TL.row),col:Math.max(n.BR.col,t[0].length-1+n.TL.col)},null,"paste");a.setRangeEnd(r)},100)}function l(t){var r,i;s.lastKeyCode=t.keyCode;if(a.isSelected()){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;if(n.helper.isPrintableChar(t.keyCode)){!s.isCellEdited&&!o?f.beginEditing():o&&(!s.isCellEdited&&t.keyCode===65?a.selectAll():!s.isCellEdited&&t.keyCode===88&&e.browser.opera?s.editProxy.triggerHandler("cut"):!s.isCellEdited&&t.keyCode===86&&e.browser.opera?s.editProxy.triggerHandler("paste"):t.keyCode===89||t.shiftKey&&t.keyCode===90?s.undoRedo&&s.undoRedo.redo():t.keyCode===90&&s.undoRedo&&s.undoRedo.undo());return}var l=t.shiftKey?a.setRangeEnd:a.setRangeStart;switch(t.keyCode){case 38:if(v())return!0;if(!s.isCellEdited){t.shiftKey?a.transformEnd(-1,0):a.transformStart(-1,0);t.preventDefault()}else f.finishEditing(!1,-1,0);break;case 9:r=s.settings.tabMoves.row;i=s.settings.tabMoves.col;v()||(t.shiftKey?f.finishEditing(!1,-r,-i):f.finishEditing(!1,r,i));t.preventDefault();break;case 39:if(!s.isCellEdited){t.shiftKey?a.transformEnd(0,1):a.transformStart(0,1);t.preventDefault()}else if(f.getCaretPosition()===s.editProxy.val().length){f.finishEditing(!1,0,1);v()&&v().shown&&v().hide()}break;case 37:if(!s.isCellEdited){t.shiftKey?a.transformEnd(0,-1):a.transformStart(0,-1);t.preventDefault()}else if(f.getCaretPosition()===0){f.finishEditing(!1,0,-1);v()&&v().shown&&v().hide()}break;case 8:case 46:if(!s.isCellEdited){a.empty(t);t.preventDefault()}break;case 40:if(!s.isCellEdited)t.shiftKey?a.transformEnd(1,0):a.transformStart(1,0);else{if(v())return!0;f.finishEditing(!1,1,0)}break;case 27:s.isCellEdited&&f.finishEditing(!0,0,0);break;case 113:if(!s.isCellEdited){f.beginEditing(!0);t.preventDefault()}break;case 13:r=s.settings.enterMoves.row;i=s.settings.enterMoves.col;if(s.isCellEdited)if(t.ctrlKey&&!a.isMultiple()||t.altKey){s.editProxy.val(s.editProxy.val()+"\n");s.editProxy[0].focus()}else v()||(t.shiftKey?f.finishEditing(!1,-r,-i,o):f.finishEditing(!1,r,i,o));else t.shiftKey?a.transformStart(-r,-i):s.settings.enterBeginsEditing?o&&!a.isMultiple()||t.altKey?f.beginEditing(!0,"\n"):f.beginEditing(!0):a.transformStart(r,i,!0);t.preventDefault();break;case 36:s.isCellEdited||(t.ctrlKey||t.metaKey?l(u.getCellAtCoords({row:0,col:s.selStart.col})):l(u.getCellAtCoords({row:s.selStart.row,col:0})));break;case 35:s.isCellEdited||(t.ctrlKey||t.metaKey?l(u.getCellAtCoords({row:p.rowCount-1,col:s.selStart.col})):l(u.getCellAtCoords({row:s.selStart.row,col:p.colCount-1})));break;case 33:l(u.getCellAtCoords({row:0,col:s.selStart.col}));break;case 34:l(u.getCellAtCoords({row:p.rowCount-1,col:s.selStart.col}));break;default:}}}function c(){var e;if(v()){var t=s.editProxy.val();if(t!==d&&t===s.lastAutoComplete){s.isCellEdited=!0;s.lastKeyCode===9?e=s.settings.tabMoves:e=s.settings.enterMoves;f.finishEditing(!1,e.row,e.col)}d=t}}s.editProxy=e('<textarea class="handsontableInput">');s.editProxyHolder=e('<div class="handsontableInputHolder">');s.editProxyHolder.append(s.editProxy);s.editProxy.on("click",t);s.editProxy.on("cut",i);s.editProxy.on("paste",o);s.editProxy.on("keydown",l);s.editProxy.on("change",c);r.append(s.editProxyHolder)},prepare:function(){if(s.isCellEdited)return;s.editProxy.height(s.editProxy.parent().innerHeight()-4);s.editProxy.val(o.getText(s.selStart,s.selEnd));setTimeout(f.focus,1);if(s.settings.autoComplete){var t=s.editProxy.data("typeahead");if(!t){s.editProxy.typeahead({updater:function(e){s.lastAutoComplete=e;return e}});t=s.editProxy.data("typeahead")}t.source=[];for(var n=0,i=s.settings.autoComplete.length;n<i;n++)if(s.settings.autoComplete[n].match(s.selStart.row,s.selStart.col,o.getAll)){t.source=s.settings.autoComplete[n].source(s.selStart.row,s.selStart.col);t.highlighter=s.settings.autoComplete[n].highlighter||g;break}}var a=u.getCellAtCoords(s.selStart),l=e(a),c=l.offset(),h=r.offset(),d=r.scrollTop(),v=r.scrollLeft(),m=c.top-h.top+d-1,y=c.left-h.left+v-1;m<0&&(m=0);y<0&&(y=0);p.blockedRows.count()>0&&parseInt(l.css("border-top-width"))>0&&(m+=1);p.blockedCols.count()>0&&parseInt(l.css("border-left-width"))>0&&(y+=1);e.browser.msie&&parseInt(e.browser.version,10)<=7&&(m-=1);s.editProxyHolder.addClass("htHidden");s.editProxyHolder.css({top:m,left:y,overflow:"hidden"});s.editProxy.css({width:0,height:0})},focus:function(){s.editProxy[0].select()},getCaretPosition:function(){var e=s.editProxy[0];if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(t==null)return 0;var n=e.createTextRange(),r=n.duplicate();n.moveToBookmark(t.getBookmark());r.setEndPoint("EndToStart",n);return r.text.length}return 0},setCaretPosition:function(e){var t=s.editProxy[0];if(t.setSelectionRange){t.focus();t.setSelectionRange(e,e)}else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0);n.moveEnd("character",e);n.moveStart("character",e);n.select()}},beginEditing:function(t,n){if(s.isCellEdited)return;var r=u.getCellAtCoords(s.selStart),i=e(r);if(!u.isCellWritable(i))return;s.fillHandle&&c.hideHandle();s.isCellEdited=!0;d="";if(t){var a=o.get(s.selStart.row,s.selStart.col)+(n||"");s.editProxy.val(a);f.setCaretPosition(a.length)}else s.editProxy.val("");var l,h;if(s.editProxy.autoResize){l=i.width();h=i.outerHeight()-4}else{l=i.width()*1.5;h=i.height()}parseInt(i.css("border-top-width"))>0&&(h-=1);parseInt(i.css("border-left-width"))>0&&p.blockedCols.count()>0&&(l-=1);s.editProxy.autoResize?s.editProxy.autoResize({maxHeight:200,minHeight:h,minWidth:l,maxWidth:Math.max(168,l),animate:!1,extraSpace:0}):s.editProxy.css({width:l,height:h});s.editProxyHolder.removeClass("htHidden");s.editProxyHolder.css({overflow:"visible"})},finishEditing:function(t,n,r,i){if(s.isCellEdited){s.isCellEdited=!1;var o=[[e.trim(s.editProxy.val())]];if(!t){var f;if(i){var l=u.getCornerCoords([s.selStart,s.selEnd]);f=u.populateFromArray(l.TL,o,l.BR,!1,"edit")}else f=u.populateFromArray(s.selStart,o,null,!1,"edit")}s.editProxy.css({width:0,height:0});s.editProxyHolder.addClass("htHidden");s.editProxyHolder.css({overflow:"hidden"})}f&&typeof n!="undefined"&&typeof r!="undefined"&&a.transformStart(n,r,!s.settings.enterBeginsEditing)}};h={onMouseDown:function(e){s.isMouseDown=!0;if(e.button!==2||!a.inInSelection(u.getCellCoords(this)))e.shiftKey?a.setRangeEnd(this):a.setRangeStart(this)},onMouseOver:function(){if(s.isMouseDown)a.setRangeEnd(this);else if(s.fillHandle&&s.fillHandle.isDragged){s.fillHandle.isDragged++;c.showBorder(this)}},onDblClick:function(){s.editProxy[0].focus();f.beginEditing(!0);s.settings.autoComplete&&s.editProxy.data("typeahead").lookup()}};this.init=function(){function n(){s.isMouseOverTable=!0}function d(){s.isMouseOverTable=!1}function g(){s.isMouseDown&&setTimeout(f.focus,1);s.isMouseDown=!1;if(s.fillHandle&&s.fillHandle.isDragged){s.fillHandle.isDragged>1&&c.apply();s.fillHandle.isDragged=0}}function y(t){setTimeout(function(){!s.isMouseOverTable&&t.target!==s.tableContainer&&e(t.target).attr("id")!=="context-menu-layer"&&a.deselect()},1)}p.curScrollTop=p.curScrollLeft=0;p.lastScrollTop=p.lastScrollLeft=null;s.scrollbarSize=m();var v=e('<div><table cellspacing="0" cellpadding="0"><thead></thead><tbody></tbody></table></div>');s.tableContainer=v[0];p.table=e(s.tableContainer.firstChild);s.tableBody=p.table.find("tbody")[0];p.table.on("mousedown","td",h.onMouseDown);p.table.on("mouseover","td",h.onMouseOver);p.table.on("dblclick","td",h.onDblClick);r.append(v);p.colCount=i.cols;p.rowCount=0;l.init();s.currentBorder=new N(r,{className:"current",bg:!0});f.init();this.updateSettings(i);r.on("mouseenter",n).on("mouseleave",d);e(s.currentBorder.main).on("dblclick",h.onDblClick);e("html").on("mouseup",g);e("html").on("click",y);r[0].tagName.toLowerCase()==="html"||r[0].tagName.toLowerCase()==="body"||r.css("overflow")!=="scroll"&&r.css("overflow")!=="auto"?r.parents().each(function(){if(this.tagName.toLowerCase()!=="html"&&this.tagName.toLowerCase()!=="body"&&(e(this).css("overflow")==="scroll"||e(this).css("overflow")==="auto")){s.scrollable=e(this);return!1}}):s.scrollable=r;if(s.scrollable){s.scrollable.scrollTop(0);s.scrollable.scrollLeft(0);s.scrollable.on("scroll.handsontable",function(){p.curScrollTop=s.scrollable[0].scrollTop;p.curScrollLeft=s.scrollable[0].scrollLeft;if(p.curScrollTop!==p.lastScrollTop){p.blockedRows.refreshBorders();p.blockedRows.main[0].style.top=p.curScrollTop+"px"}if(p.curScrollLeft!==p.lastScrollLeft){p.blockedCols.refreshBorders();p.blockedCols.main[0].style.left=p.curScrollLeft+"px"}if(s.cornerHeader&&(p.curScrollTop!==p.lastScrollTop||p.curScrollLeft!==p.lastScrollLeft)){if(p.curScrollTop===0&&p.curScrollLeft===0){s.cornerHeader.find("th:last-child").css({borderRightWidth:0});s.cornerHeader.find("tr:last-child th").css({borderBottomWidth:0})}else if(p.lastScrollTop===0&&p.lastScrollLeft===0){s.cornerHeader.find("th:last-child").css({borderRightWidth:"1px"});s.cornerHeader.find("tr:last-child th").css({borderBottomWidth:"1px"})}s.cornerHeader[0].style.top=p.curScrollTop+"px";s.cornerHeader[0].style.left=p.curScrollLeft+"px"}p.lastScrollTop=p.curScrollTop;p.lastScrollLeft=p.curScrollLeft});s.scrollable.trigger("scroll.handsontable")}else{s.scrollable=e(t);if(s.cornerHeader){s.cornerHeader.find("th:last-child").css({borderRightWidth:0});s.cornerHeader.find("tr:last-child th").css({borderBottomWidth:0})}}s.scrollable.on("scroll",function(e){e.stopPropagation()});if(s.settings.contextMenu){var b=function(e){var t=u.getCornerCoords([s.selStart,s.selEnd]);switch(e){case"row_above":u.alter("insert_row",t.TL);break;case"row_below":u.alter("insert_row",{row:t.BR.row+1,col:0});break;case"col_left":u.alter("insert_col",t.TL);break;case"col_right":u.alter("insert_col",{row:0,col:t.BR.col+1});break;case"remove_row":case"remove_col":u.alter(e,t.TL,t.BR);break;case"undo":case"redo":s.undoRedo[e]()}},w=function(t){if(!p.blockedCols.main.find("th.htRowHeader.active").length||t!=="remove_col"&&t!=="col_left"&&t!=="col_right"){if(!p.blockedRows.main.find("th.htColHeader.active").length||t!=="remove_row"&&t!=="row_above"&&t!=="row_below"){if(s.selStart){var n=u.getCornerCoords([s.selStart,s.selEnd]);if((t==="row_above"||t==="remove_row")&&n.TL.row===0||(t==="col_left"||t==="remove_col")&&n.TL.col===0)if(e(u.getCellAtCoords(n.TL)).data("readOnly"))return!0;return!1}return!0}return!0}return!0},E={undo:{name:"Undo",disabled:function(){return s.undoRedo?!s.undoRedo.isUndoAvailable():!0}},redo:{name:"Redo",disabled:function(){return s.undoRedo?!s.undoRedo.isRedoAvailable():!0}},sep1:"---------",row_above:{name:"Insert row above",disabled:w},row_below:{name:"Insert row below",disabled:w},sep2:"---------",col_left:{name:"Insert column on the left",disabled:w},col_right:{name:"Insert column on the right",disabled:w},sep3:"---------",remove_row:{name:"Remove row",disabled:w},remove_col:{name:"Remove column",disabled:w}};s.settings.contextMenu===!0&&(s.settings.contextMenu=["row_above","row_below","sep2","col_left","col_right","sep3","remove_row","remove_col"]);var S={};for(var x=0,T=s.settings.contextMenu.length;x<T;x++)S[s.settings.contextMenu[x]]=E[s.settings.contextMenu[x]];e.contextMenu({selector:r.attr("id")?"#"+r.attr("id"):"."+r[0].className.replace(/[\s]+/g,"."),trigger:"right",callback:b,items:S});e(".context-menu-root").on("mouseenter",n).on("mouseleave",d)}p.container.on("beforedatachange.handsontable",function(e,t){if(s.settings.autoComplete){var n=s.editProxy.data("typeahead");e:for(var r=0,i=t.length;r<i;r++)for(var u=0,a=s.settings.autoComplete.length;u<a;u++){var f=s.settings.autoComplete[u],l=f.source();if(f.match(t[r][0],t[r][1],o.getAll)){var c=t[r][3].toLowerCase();for(var h=0,p=l.length;h<p;h++){if(t[r][3]===l[h])continue e;if(c===l[h].toLowerCase()){t[r][3]=l[h];continue e}}f.strict&&(t[r][3]=!1)}}}if(s.settings.onBeforeChange){var d=s.settings.onBeforeChange(t);d===!1&&t.splice(0,t.length)}});p.container.on("datachange.handsontable",function(e,t,n){s.settings.onChange&&s.settings.onChange(t,n)})};this.setDataAtCell=function(e,t,n,r,i){var f=!1,l=!1,c,h,d;typeof e=="object"?c=e:typeof n=="object"?c=n:c=[[e,t,n,r]];for(h=0,d=c.length;h<d;h++)c[h].splice(2,0,o.get(c[h][0],c[h][1]));p.container.triggerHandler("beforedatachange.handsontable",[c]);for(h=0,d=c.length;h<d;h++){if(c[h][3]===!1)continue;e=c[h][0];t=c[h][1];n=c[h][3];r=c[h][4]||r;if(s.settings.minSpareRows)while(e>p.rowCount-1){o.createRow();u.createRow();f=!0}if(s.settings.minSpareCols)while(t>p.colCount-1){o.createCol();u.createCol();l=!0}var v=u.getCellAtCoords({row:e,col:t});switch(typeof n){case"string":break;case"number":n+="";break;default:n=""}!r;v.innerHTML=n.replace(/\n/g,"<br/>");p.minWidthFix(v);o.set(e,t,n);u.updateLegend({row:e,col:t})}f&&p.blockedCols.refresh();l&&p.blockedRows.refresh();var m=u.keepEmptyRows();m||a.refreshBorders();setTimeout(function(){f||p.blockedRows.dimensions(c);l||p.blockedCols.dimensions(c)},10);c.length&&p.container.triggerHandler("datachange.handsontable",[c,i||"edit"]);return v};this.getSelected=function(){if(a.isSelected()){var e=u.getCornerCoords([s.selStart,s.selEnd]);return[e.TL.row,e.TL.col,e.BR.row,e.BR.col]}};this.loadData=function(e,t){s.isPopulated=!1;o.clear();u.clear();u.populateFromArray({row:0,col:0},e,null,t,"loadData");s.isPopulated=!0;p.clearUndo()};this.getData=function(t){return t===!0?o.getAll():e.extend(!0,[],o.getAll())};this.refreshLegend=function(e,t){var n,r,i,o,a,f;if(typeof e!="undefined"&&e!==null)n=e+1;else{e=0;n=p.rowCount}if(typeof t!="undefined"&&t!==null)r=t+1;else{t=0;r=p.colCount}for(i=e,o=n;i<o;i+=1)for(a=t,f=r;a<f;a+=1)u.updateLegend({row:i,col:a});s.legendDirty=!1};this.updateSettings=function(t){var i,o;typeof t.fillHandle!="undefined"&&(s.fillHandle&&t.fillHandle===!1?c.disable():!s.fillHandle&&t.fillHandle===!0&&c.init());typeof t.undo!="undefined"&&(s.undoRedo&&t.undo===!1?s.undoRedo=null:!s.undoRedo&&t.undo===!0&&(s.undoRedo=new n.UndoRedo(p)));if(!p.blockedCols){p.blockedCols=new n.BlockedCols(p);p.blockedRows=new n.BlockedRows(p)}typeof t.legend!="undefined"&&(s.legendDirty=!0);for(i in t)if(t.hasOwnProperty(i)){s.settings[i]=t[i];n.extension[i]&&(s.extensions[i]=new n.extension[i](p,t[i]))}typeof t.colHeaders!="undefined"&&(t.colHeaders===!1&&s.extensions.ColHeader?s.extensions.ColHeader.destroy():s.extensions.ColHeader=new n.ColHeader(p,t.colHeaders));typeof t.rowHeaders!="undefined"&&(t.rowHeaders===!1&&s.extensions.RowHeader?s.extensions.RowHeader.destroy():s.extensions.RowHeader=new n.RowHeader(p,t.rowHeaders));var f=p.blockedRows.count(),l=p.blockedCols.count();if(f&&l&&(typeof t.rowHeaders!="undefined"||typeof t.colHeaders!="undefined")){if(s.cornerHeader){s.cornerHeader.remove();s.cornerHeader=null}var h=p.table.position();p.positionFix(h);var d=document.createElement("div");d.style.position="absolute";d.style.top=h.top+"px";d.style.left=h.left+"px";var v=document.createElement("table");v.cellPadding=0;v.cellSpacing=0;d.appendChild(v);var m=document.createElement("thead");v.appendChild(m);var g,y;for(i=0;i<f;i++){g=document.createElement("tr");for(o=l-1;o>=0;o--){y=document.createElement("th");y.className=p.blockedCols.headers[o].className;y.innerHTML=p.blockedCols.headerText("&nbsp;");p.minWidthFix(y);g.appendChild(y)}m.appendChild(g)}s.cornerHeader=e(d);s.cornerHeader.on("click",function(){a.selectAll()});r.append(s.cornerHeader)}else if(s.cornerHeader){s.cornerHeader.remove();s.cornerHeader=null}p.blockedCols.update();p.blockedRows.update();var b=u.keepEmptyRows();b||a.refreshBorders();s.isPopulated&&s.legendDirty&&p.refreshLegend()};this.clear=function(){a.selectAll();a.empty()};this.clearUndo=
function(){s.undoRedo&&s.undoRedo.clear()};this.alter=function(e,t,n){typeof n=="undefined"&&(n=t);switch(e){case"insert_row":case"remove_row":u.alter(e,{row:t,col:0},{row:n,col:0});break;case"insert_col":case"remove_col":u.alter(e,{row:0,col:t},{row:0,col:n});break;default:throw Error('There is no such action "'+e+'"')}};this.getCell=function(e,t){return u.getCellAtCoords({row:e,col:t})};this.getDataAtCell=function(e,t){return o.get(e,t)};this.getCellMeta=function(t,n){return{isWritable:u.isCellWritable(e(u.getCellAtCoords({row:t,col:n})))}};this.setCellReadOnly=function(t,n){e(u.getCellAtCoords({row:t,col:n})).data("readOnly",!0)};this.setCellEditable=function(t,n){e(u.getCellAtCoords({row:t,col:n})).data("readOnly",!1)};var T=function(e,t,n){if(e){if(typeof n!="undefined")return e.columnLabel(n);var r=[];for(var i=0;i<t;i++)r.push(e.columnLabel(i));return r}};this.getRowHeader=function(e){return T(p.rowHeader,p.rowCount,e)};this.getColHeader=function(e){return T(p.colHeader,p.colCount,e)};this.selectCell=function(e,t,n,r,i){a.start({row:e,col:t});typeof n=="undefined"?a.setRangeEnd(p.getCell(e,t),i):a.setRangeEnd(p.getCell(n,r),i)};this.deselectCell=function(){a.deselect()};N.prototype={appear:function(t){var n,r,i,s,o,a,f,l,c,h,p;if(this.disabled)return;this.corners=u.getCornerCoords(t);n=e(u.getCellAtCoords(this.corners.TL));r=t.length>1?e(u.getCellAtCoords(this.corners.BR)):n;i=n.offset();s=t.length>1?r.offset():i;o=this.$container.offset();f=i.top;h=s.top+r.outerHeight()-f;c=i.left;p=s.left+r.outerWidth()-c;a=f-o.top+this.$container.scrollTop()-1;l=c-o.left+this.$container.scrollLeft()-1;if(parseInt(n.css("border-top-width"))>0){a+=1;h-=1}if(parseInt(n.css("border-left-width"))>0){l+=1;p-=1}a<0&&(a=0);l<0&&(l=0);if(this.bg){this.bg.style.top=a+"px";this.bg.style.left=l+"px";this.bg.style.width=p+"px";this.bg.style.height=h+"px";this.bg.style.display="block"}this.top.style.top=a+"px";this.top.style.left=l+"px";this.top.style.width=p+"px";this.left.style.top=a+"px";this.left.style.left=l+"px";this.left.style.height=h+"px";var d=Math.floor(this.borderWidth/2);this.bottom.style.top=a+h-d+"px";this.bottom.style.left=l+"px";this.bottom.style.width=p+"px";this.right.style.top=a+"px";this.right.style.left=l+p-d+"px";this.right.style.height=h+1+"px";this.main.style.display="block"},disappear:function(){this.main.style.display="none";this.bg&&(this.bg.style.display="none");this.corners=null}};C.prototype={appear:function(t){if(this.disabled)return;var n,r,i,s,o,a,f,l=u.getCornerCoords(t);n=e(u.getCellAtCoords(l.BR));r=n.offset();i=this.$container.offset();s=r.top-i.top+this.$container.scrollTop()-1;o=r.left-i.left+this.$container.scrollLeft()-1;a=n.outerHeight();f=n.outerWidth();this.handle.style.top=s+a-3+"px";this.handle.style.left=o+f-3+"px";this.handle.style.display="block"},disappear:function(){this.handle.style.display="none"}}};var r={rows:5,cols:5,minSpareRows:0,minSpareCols:0,minHeight:0,minWidth:0,multiSelect:!0,fillHandle:!0,undo:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1};e.fn.handsontable=function(t,i){var s,o,u,a=[];if(typeof t!="string"){i=t;return this.each(function(){var t=e(this);if(t.data("handsontable")){o=t.data("handsontable");o.updateSettings(i)}else{var s=e.extend({},r),o;i&&e.extend(s,i);o=new n.Core(t,s);t.data("handsontable",o);o.init()}})}u=[];if(arguments.length>1)for(s=1,o=arguments.length;s<o;s++)u.push(arguments[s]);this.each(function(){a=e(this).data("handsontable")[t].apply(this,u)});return a}})(jQuery,window,Handsontable);Handsontable.helper.isPrintableChar=function(e){return e==32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90};(function(e){"use strict";Handsontable.UndoRedo=function(e){var t=this;this.instance=e;this.clear();e.container.on("datachange.handsontable",function(e,n,r){r!=="undo"&&r!=="redo"&&t.add(n)})};Handsontable.UndoRedo.prototype.undo=function(){var t,n;if(this.isUndoAvailable()){var r=e.extend(!0,[],this.data[this.rev]);for(t=0,n=r.length;t<n;t++)r[t].splice(3,1);this.instance.setDataAtCell(r,null,null,!0,"undo");this.rev--}};Handsontable.UndoRedo.prototype.redo=function(){var t,n;if(this.isRedoAvailable()){this.rev++;var r=e.extend(!0,[],this.data[this.rev]);for(t=0,n=r.length;t<n;t++)r[t].splice(2,1);this.instance.setDataAtCell(r,null,null,!0,"redo")}};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.rev>=0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.rev<this.data.length-1};Handsontable.UndoRedo.prototype.add=function(e){this.rev++;this.data.splice(this.rev);this.data.push(e)};Handsontable.UndoRedo.prototype.clear=function(){this.data=[];this.rev=-1}})(jQuery);(function(e){"use strict";Handsontable.BlockedRows=function(t){this.instance=t;this.headers=[];var n=t.table.position();t.positionFix(n);this.main=e('<div style="position: absolute; top: '+n.top+"px; left: "+n.left+'px"><table cellspacing="0" cellpadding="0"><thead></thead></table></div>');this.instance.container.append(this.main);this.hasCSS3=!(e.browser.msie&&parseInt(e.browser.version,10)<=8);this.update()};Handsontable.BlockedRows.prototype.count=function(){return this.headers.length};Handsontable.BlockedRows.prototype.createCol=function(t){var n,r,i,s=this.count();for(i=0;i<s;i++){n=this.main.find("thead tr."+this.headers[i].className);if(!n.length){n=e('<tr class="'+this.headers[i].className+'"></tr>');this.main.find("thead").append(n)}n=this.instance.table.find("thead tr."+this.headers[i].className);if(!n.length){n=e('<tr class="'+this.headers[i].className+'"></tr>');this.instance.table.find("thead").append(n)}r=document.createElement("th");r.className=this.headers[i].className;t&&(r.className+=" "+t);r.innerHTML=this.headerText("&nbsp;");this.instance.minWidthFix(r);this.instance.table.find("thead tr."+this.headers[i].className)[0].appendChild(r);r=document.createElement("th");r.className=this.headers[i].className;t&&(r.className+=" "+t);this.instance.minWidthFix(r);this.main.find("thead tr."+this.headers[i].className)[0].appendChild(r)}};Handsontable.BlockedRows.prototype.create=function(){var e;if(this.count()>0){this.instance.table.find("thead").empty();this.main.find("thead").empty();var t=this.instance.blockedCols.count();for(e=t-1;e>=0;e--)this.createCol(this.instance.blockedCols.headers[e].className);for(e=0;e<this.instance.colCount;e++)this.createCol()}if(!this.hasCSS3){this.instance.container.find("thead tr.lastChild").not(":last-child").removeClass("lastChild");this.instance.container.find("thead tr:last-child").not(".lastChild").addClass("lastChild")}};Handsontable.BlockedRows.prototype.refresh=function(){var t;if(this.count()>0){var n=this,r=this.count(),i;for(i=0;i<r;i++){var s=this.main.find("thead tr."+this.headers[i].className),o=s[0],u=o.childNodes,a=u.length,f=this.instance.blockedCols.count();while(a>this.instance.colCount+f){a--;e(o.childNodes[a]).remove()}for(i=0;i<r;i++){var l=this.instance.table.find("thead th."+this.headers[i].className);for(var c=0;c<a;c++){t=n.headers[i].columnLabel(c-f);if(this.headers[i].format&&this.headers[i].format==="small"){l[c].innerHTML=this.headerText(t);u[c].innerHTML=this.headerText(t)}else{l[c].innerHTML=t;u[c].innerHTML=t}this.instance.minWidthFix(l[c]);this.instance.minWidthFix(u[c]);u[c].style.minWidth=l.eq(c).width()+"px"}}}this.ths=this.main.find("tr:last-child th");this.refreshBorders()}};Handsontable.BlockedRows.prototype.refreshBorders=function(){this.count()>0&&(this.instance.curScrollTop===0?this.ths.css("borderBottomWidth",0):this.instance.lastScrollTop===0&&this.ths.css("borderBottomWidth","1px"))};Handsontable.BlockedRows.prototype.dimensions=function(t){if(this.count()>0){var n=this.instance.blockedCols.count();for(var r=0,i=t.length;r<i;r++)this.ths[t[r][1]+n].style.minWidth=e(this.instance.getCell(t[r][0],t[r][1])).width()+"px"}};Handsontable.BlockedRows.prototype.update=function(){this.create();this.refresh()};Handsontable.BlockedRows.prototype.addHeader=function(e){for(var t=this.count()-1;t>=0;t--)this.headers[t].className===e.className&&this.headers.splice(t,1);this.headers.push(e);this.headers.sort(function(e,t){return e.priority||0-t.priority||0});this.update()};Handsontable.BlockedRows.prototype.destroyHeader=function(e){for(var t=this.count()-1;t>=0;t--)if(this.headers[t].className===e){this.main.find("thead tr."+this.headers[t].className).remove();this.instance.table.find("thead tr."+this.headers[t].className).remove();this.headers.splice(t,1)}};Handsontable.BlockedRows.prototype.headerText=function(e){return'&nbsp;<span class="small">'+e+"</span>&nbsp;"}})(jQuery);(function(e){"use strict";Handsontable.BlockedCols=function(t){this.heightMethod=e.browser.mozilla||e.browser.opera?"outerHeight":"height";this.instance=t;this.headers=[];var n=t.table.position();t.positionFix(n);this.main=e('<div style="position: absolute; top: '+n.top+"px; left: "+n.left+'px"><table cellspacing="0" cellpadding="0"><thead><tr></tr></thead><tbody></tbody></table></div>');this.instance.container.append(this.main)};Handsontable.BlockedCols.prototype.count=function(){return this.headers.length};Handsontable.BlockedCols.prototype.createRow=function(e){var t,n=document.createElement("tr");for(var r=0,i=this.count();r<i;r++){t=document.createElement("th");t.className=this.headers[r].className;this.instance.minWidthFix(t);e.insertBefore(t,e.firstChild);t=document.createElement("th");t.className=this.headers[r].className;n.insertBefore(t,n.firstChild)}this.main.find("tbody")[0].appendChild(n)};Handsontable.BlockedCols.prototype.create=function(){var e=this.count(),t,n;this.main.find("tbody").empty();this.instance.table.find("tbody th").remove();var r=this.main.find("thead tr");r.empty();if(e>0){var i=this.instance.blockedRows.count();if(i)for(t=0;t<e;t++){n=r[0].getElementsByClassName?r[0].getElementsByClassName(this.headers[t].className)[0]:r.find("."+this.headers[t].className.replace(/\s/i,"."))[0];if(!n){n=document.createElement("th");n.className=this.headers[t].className;n.innerHTML=this.headerText("&nbsp;");this.instance.minWidthFix(n);r[0].insertBefore(n,r[0].firstChild)}}var s=this.instance.table.find("tbody")[0].childNodes;for(var o=0;o<this.instance.rowCount;o++)this.createRow(s[o])}};Handsontable.BlockedCols.prototype.refresh=function(){var t=this.count(),n,r,i,s,o;if(t>0){var u=this.main.find("tbody"),a=u[0],f=a.childNodes,l=f.length;while(l>this.instance.rowCount){l--;e(a.childNodes[l]).remove()}var c=this.instance.table.find("tbody tr");for(s=0;s<l;s++)for(n=0;n<t;n++){o=this.headers[n].columnLabel(s);i=c[s].getElementsByClassName?c[s].getElementsByClassName(this.headers[n].className)[0]:e(c[s]).find("."+this.headers[n].className.replace(/\s/i,"."))[0];r=f[s].getElementsByClassName?f[s].getElementsByClassName(this.headers[n].className)[0]:e(f[s]).find("."+this.headers[n].className.replace(/\s/i,"."))[0];if(this.headers[n].format&&this.headers[n].format==="small"){i.innerHTML=this.headerText(o);r.innerHTML=this.headerText(o)}else{i.innerHTML=o;r.innerHTML=o}this.instance.minWidthFix(r);r.style.height=e(i)[this.heightMethod]()+"px"}this.ths=this.main.find("th:last-child");this.refreshBorders()}};Handsontable.BlockedCols.prototype.refreshBorders=function(){this.count()>0&&(this.instance.curScrollLeft===0?this.ths.css("borderRightWidth",0):this.instance.lastScrollLeft===0&&this.ths.css("borderRightWidth","1px"))};Handsontable.BlockedCols.prototype.dimensions=function(t){if(this.count()>0){var n=this.main[0].firstChild.getElementsByTagName("tbody")[0].childNodes;for(var r=0,i=t.length;r<i;r++){var s=e(this.instance.getCell(t[r][0],t[r][1]));s.length&&(n[t[r][0]].firstChild.style.height=s[this.heightMethod]()+"px")}}};Handsontable.BlockedCols.prototype.update=Handsontable.BlockedRows.prototype.update;Handsontable.BlockedCols.prototype.addHeader=function(e){for(var t=this.count()-1;t>=0;t--)this.headers[t].className===e.className&&this.headers.splice(t,1);this.headers.push(e);this.headers.sort(function(e,t){return e.priority||0-t.priority||0})};Handsontable.BlockedCols.prototype.destroyHeader=function(e){for(var t=this.count()-1;t>=0;t--)this.headers[t].className===e&&this.headers.splice(t,1)};Handsontable.BlockedCols.prototype.headerText=Handsontable.BlockedRows.prototype.headerText})(jQuery);(function(e){"use strict";Handsontable.RowHeader=function(t,n){var r=this;this.className="htRowHeader";t.blockedCols.main.on("mousedown","th.htRowHeader",function(n){if(!e(n.target).hasClass("btn")&&!e(n.target).hasClass("btnContainer")){t.deselectCell();e(this).addClass("active");r.lastActive=this;var i=t.blockedRows.count();t.selectCell(this.parentNode.rowIndex-i,0,this.parentNode.rowIndex-i,t.colCount-1,!1)}});t.container.on("deselect.handsontable",function(){r.deselect()});this.labels=n;this.instance=t;this.instance.rowHeader=this;this.format="small";t.blockedCols.addHeader(this)};Handsontable.RowHeader.prototype.columnLabel=function(e){return typeof this.labels[e]!="undefined"?this.labels[e]:e+1};Handsontable.RowHeader.prototype.deselect=function(){if(this.lastActive){e(this.lastActive).removeClass("active");this.lastActive=null}};Handsontable.RowHeader.prototype.destroy=function(){this.instance.blockedCols.destroyHeader(this.className)}})(jQuery);(function(e){"use strict";Handsontable.ColHeader=function(t,n){var r=this;this.className="htColHeader";t.blockedRows.main.on("mousedown","th.htColHeader",function(){t.deselectCell();var n=e(this);n.addClass("active");r.lastActive=this;var i=n.index(),s=t.blockedCols?t.blockedCols.count():0;t.selectCell(0,i-s,t.rowCount-1,i-s,!1)});t.container.on("deselect.handsontable",function(){r.deselect()});this.instance=t;this.labels=n;this.instance.colHeader=this;this.format="small";t.blockedRows.addHeader(this)};Handsontable.ColHeader.prototype.columnLabel=function(e){if(typeof this.labels[e]!="undefined")return this.labels[e];var t=e+1,n="",r;while(t>0){r=(t-1)%26;n=String.fromCharCode(65+r)+n;t=parseInt((t-r)/26)}return n};Handsontable.ColHeader.prototype.deselect=Handsontable.RowHeader.prototype.deselect;Handsontable.ColHeader.prototype.destroy=function(){this.instance.blockedRows.destroyHeader(this.className)}})(jQuery);